"use strict";(self["webpackChunkrx_ts"]=self["webpackChunkrx_ts"]||[]).push([[390],{6478:function(e,t,a){a.d(t,{Z:function(){return d}});var l=a(3396);const o={class:"navi"};function i(e,t,a,i,n,c){const s=(0,l.up)("van-nav-bar");return(0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(s,{title:e.title,"left-text":"返回","right-text":e.rightText,fixed:e.fixed,"left-arrow":"",onClickLeft:e.back,onClickRight:e.clickRight},null,8,["title","right-text","fixed","onClickLeft","onClickRight"])])}var n=a(678),c=(0,l.aZ)({name:"Navi",props:{title:{type:String,default:""},rightText:{type:String,default:""},fixed:{type:Boolean,default:!1}},setup(e,{emit:t}){let a=(0,n.tv)(),l=()=>{a.go(-1)},o=()=>{t("click-right")};return{back:l,clickRight:o}}}),s=a(89);const u=(0,s.Z)(c,[["render",i],["__scopeId","data-v-40ff0b7a"]]);var d=u},6390:function(e,t,a){a.r(t),a.d(t,{default:function(){return T}});var l=a(3396),o=a(9242);const i=e=>((0,l.dD)("data-v-73fe202a"),e=e(),(0,l.Cn)(),e),n={class:"shopbag"},c=i((()=>(0,l._)("div",{class:"shopbag-bg"},null,-1))),s={key:0},u={class:"shopbag-list"},d={key:0},r=(0,l.Uk)("全选"),h=(0,l.Uk)("全选"),p={key:1},g=(0,l.Uk)("去登录"),m={key:2};function v(e,t,a,i,v,b){const f=(0,l.up)("Navi"),k=(0,l.up)("ShopbagItem"),C=(0,l.up)("van-button"),S=(0,l.up)("van-swipe-cell"),_=(0,l.up)("van-checkbox"),w=(0,l.up)("van-submit-bar"),x=(0,l.up)("van-empty");return(0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(f,{title:"购物袋","right-text":e.text,onClickRight:e.edit,fixed:!0},null,8,["right-text","onClickRight"]),c,e.isLogin?((0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",u,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.shopbagData,(t=>((0,l.wg)(),(0,l.iD)("div",{class:"shopbag-list-item",key:t.sid},[(0,l.Wm)(S,null,{right:(0,l.w5)((()=>[(0,l.Wm)(C,{square:"",color:"#e4393c",text:"删除",onClick:a=>e.removeShopbag([t.sid])},null,8,["onClick"])])),default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(k,{"shopbag-item-data":t,onSelectOne:e.selectOne,onUpdateCount:a=>e.updateCount(t.sid,t.count)},null,8,["shopbag-item-data","onSelectOne","onUpdateCount"])])])),_:2},1024)])))),128))]),e.shopbagData.length>0?((0,l.wg)(),(0,l.iD)("div",d,[(0,l.wy)((0,l.Wm)(w,{price:e.total,"button-text":"提交订单",onSubmit:e.commitOrder},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:e.isAllSelect,"onUpdate:modelValue":t[0]||(t[0]=t=>e.isAllSelect=t),"checked-color":"#0C34BA",onClick:e.allSelect},{default:(0,l.w5)((()=>[r])),_:1},8,["modelValue","onClick"])])),_:1},8,["price","onSubmit"]),[[o.F8,!e.isEdit]]),(0,l.wy)((0,l.Wm)(w,{"button-text":"删除选择",onSubmit:e.removeSelectShopbag},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:e.isAllSelect,"onUpdate:modelValue":t[1]||(t[1]=t=>e.isAllSelect=t),onClick:e.allSelect,"checked-color":"#0C34BA"},{default:(0,l.w5)((()=>[h])),_:1},8,["modelValue","onClick"])])),_:1},8,["onSubmit"]),[[o.F8,e.isEdit]])])):(0,l.kq)("",!0)])):((0,l.wg)(),(0,l.iD)("div",p,[(0,l.Wm)(x,{image:"error",description:"请先登录"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{round:"",type:"danger",class:"bottom-button",color:"#0C34BA",onClick:e.goLogin},{default:(0,l.w5)((()=>[g])),_:1},8,["onClick"])])),_:1})])),0===e.shopbagData.length?((0,l.wg)(),(0,l.iD)("div",m,[(0,l.Wm)(x,{description:"购物袋没有商品！"})])):(0,l.kq)("",!0)])}a(6743);var b=a(4691),f=a(4870),k=a(678),C=a(6478),S=a(7139);const _={class:"shopbag-item"},w={class:"check-box"},x={class:"shopbag-item-img"},D=["src"],y={class:"shopbag-item-content"},I={class:"shopbag-name"},W={class:"zhname-box"},V={class:"zhname one-text"},O={class:"rule one-text"},Z={class:"enname one-text"},A={class:"price-count"},E={class:"price"},L={class:"count"};function U(e,t,a,o,i,n){const c=(0,l.up)("van-checkbox"),s=(0,l.up)("van-stepper");return(0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("div",w,[(0,l.Wm)(c,{modelValue:e.shopbagItemData.isCheck,"onUpdate:modelValue":t[0]||(t[0]=t=>e.shopbagItemData.isCheck=t),"checked-color":"#0C34BA",onChange:e.selectOne},null,8,["modelValue","onChange"])]),(0,l._)("div",x,[(0,l._)("img",{class:"auto-img",src:e.shopbagItemData.small_img,alt:""},null,8,D)]),(0,l._)("div",y,[(0,l._)("div",I,[(0,l._)("div",W,[(0,l._)("div",V,(0,S.zw)(e.shopbagItemData.name),1),(0,l._)("div",O,(0,S.zw)(e.shopbagItemData.rule),1)]),(0,l._)("div",Z,(0,S.zw)(e.shopbagItemData.enname),1)]),(0,l._)("div",A,[(0,l._)("div",E,"¥"+(0,S.zw)(e.shopbagItemData.price),1),(0,l._)("div",L,[(0,l.Wm)(s,{modelValue:e.shopbagItemData.count,"onUpdate:modelValue":t[1]||(t[1]=t=>e.shopbagItemData.count=t),theme:"round","button-size":"22","disable-input":"",onChange:e.updateCount},null,8,["modelValue","onChange"])])])])])}var z=(0,l.aZ)({name:"ShopbagItem",props:{shopbagItemData:{type:Object,default(){return{}}}},setup(e,{emit:t}){let a=()=>{t("select-one")},l=()=>{t("update-count")};return{selectOne:a,updateCount:l}}}),B=a(89);const H=(0,B.Z)(z,[["render",U],["__scopeId","data-v-6e3f100b"]]);var R=H,q=a(6265),N=a.n(q),F=(0,l.aZ)({name:"Shopbag",components:{Navi:C.Z,ShopbagItem:R},setup(){let e=(0,k.tv)(),t=(0,f.iH)(!1),a=(0,f.iH)("编辑"),o=(0,f.iH)(!1),i=(0,f.iH)([]),n=(0,f.iH)(!0);const c=(0,l.Fl)((()=>{let e=0;return i.value.forEach((t=>{t.isCheck&&(e+=t.price*t.count)})),100*e}));let s=()=>{t.value=!t.value,a.value=t.value?"完成":"编辑"},u=()=>{e.push({name:"Login"})},d=()=>{N()({method:"get",url:"/findAllShopcart"}).then((e=>{if(700===e.data.code)return n.value=!1,void(a.value="");5e3===e.data.code&&(e.data.result.forEach((e=>{e.isCheck=!1})),i.value=e.data.result,0===i.value.length&&(a.value=""))})).catch((e=>{}))},r=()=>{i.value.forEach((e=>{e.isCheck=o.value}))},h=()=>{for(let e=0;e<i.value.length;e++)if(!i.value[e].isCheck)return void(o.value=!1);o.value=!0},p=(t,a)=>{N()({method:"post",url:"/modifyShopcartCount",data:{sid:t,count:a}}).then((t=>{if(700===t.data.code)return(0,b.Z)(t.data.msg),void e.push({name:"Login"})})).catch((e=>{}))},g=t=>{N()({method:"post",url:"/deleteShopcart",data:{sids:JSON.stringify(t)}}).then((l=>{(0,b.Z)(l.data.msg),700!==l.data.code?7e3===l.data.code&&(t.forEach((e=>{for(let t=i.value.length-1;t>=0;t--)if(e===i.value[t].sid){i.value.splice(t,1);break}})),h(),0===i.value.length&&(a.value="")):e.push({name:"Login"})})).catch((e=>{}))},m=()=>{let e=[];i.value.forEach((t=>{t.isCheck&&e.push(t.sid)})),g(e)},v=()=>{let t=[];i.value.forEach((e=>{e.isCheck&&t.push(e.sid)})),0!==t.length?e.push({name:"OrderBuy",query:{sids:t.join("-")}}):(0,b.Z)("请选择下单的商品")};return(0,l.bv)((()=>{d()})),{isEdit:t,text:a,isAllSelect:o,shopbagData:i,isLogin:n,total:c,edit:s,goLogin:u,getShopbagProduct:d,allSelect:r,selectOne:h,updateCount:p,removeShopbag:g,removeSelectShopbag:m,commitOrder:v}}});const j=(0,B.Z)(F,[["render",v],["__scopeId","data-v-73fe202a"]]);var T=j}}]);
//# sourceMappingURL=390.881935e0.js.map