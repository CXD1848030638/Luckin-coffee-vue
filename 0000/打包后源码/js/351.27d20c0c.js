"use strict";(self["webpackChunkrx_ts"]=self["webpackChunkrx_ts"]||[]).push([[351],{6478:function(e,t,a){a.d(t,{Z:function(){return o}});var l=a(3396);const i={class:"navi"};function d(e,t,a,d,c,u){const n=(0,l.up)("van-nav-bar");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l.Wm)(n,{title:e.title,"left-text":"返回","right-text":e.rightText,fixed:e.fixed,"left-arrow":"",onClickLeft:e.back,onClickRight:e.clickRight},null,8,["title","right-text","fixed","onClickLeft","onClickRight"])])}var c=a(678),u=(0,l.aZ)({name:"Navi",props:{title:{type:String,default:""},rightText:{type:String,default:""},fixed:{type:Boolean,default:!1}},setup(e,{emit:t}){let a=(0,c.tv)(),l=()=>{a.go(-1)},i=()=>{t("click-right")};return{back:l,clickRight:i}}}),n=a(89);const s=(0,n.Z)(u,[["render",d],["__scopeId","data-v-40ff0b7a"]]);var o=s},8351:function(e,t,a){a.r(t),a.d(t,{default:function(){return N}});var l=a(3396),i=a(7139);const d=e=>((0,l.dD)("data-v-5ddea1b1"),e=e(),(0,l.Cn)(),e),c={class:"detail"},u={class:"detail-img"},n=["src"],s={class:"detail-info"},o={class:"detail-pro"},r={class:"detail-name one-text"},v={class:"detail-enname one-text"},p={class:"detail-price"},h={class:"detail-rules"},g={class:"rules-title"},m={class:"rules"},f=["onClick"],k={class:"select-count-box"},b=d((()=>(0,l._)("div",{class:"select-text"},"选择数量",-1))),_={class:"select-count"},x={class:"detail-desc"},D=d((()=>(0,l._)("div",{class:"detail-desc-title"},"商品描述",-1))),w={class:"detail-desc-content"};function C(e,t,a,d,C,R){const Z=(0,l.up)("Navi"),z=(0,l.up)("van-stepper"),H=(0,l.up)("van-action-bar-icon"),L=(0,l.up)("van-action-bar-button"),y=(0,l.up)("van-action-bar");return(0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(Z,{title:"商品详情",fixed:!0}),(0,l._)("div",null,[(0,l._)("div",u,[(0,l._)("img",{class:"auto-img",src:e.productDetail.large_img,alt:""},null,8,n)]),(0,l._)("div",s,[(0,l._)("div",o,[(0,l._)("div",null,[(0,l._)("div",r,(0,i.zw)(e.productDetail.name),1),(0,l._)("div",v,(0,i.zw)(e.productDetail.enname),1)]),(0,l._)("div",p,"¥"+(0,i.zw)(e.productDetail.price),1)]),(0,l._)("div",h,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.productDetail.rulesData,((t,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"detail-rules-item",key:a},[(0,l._)("div",g,(0,i.zw)(t.title),1),(0,l._)("div",m,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.subRule,((a,d)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,i.C_)(["rules-item",{active:d===t.activeIndex}]),key:d,onClick:a=>e.selectRule(t,d)},(0,i.zw)(a.title),11,f)))),128))])])))),128))]),(0,l._)("div",k,[b,(0,l._)("div",_,[(0,l.Wm)(z,{modelValue:e.count,"onUpdate:modelValue":t[0]||(t[0]=t=>e.count=t),theme:"round","button-size":"22","disable-input":""},null,8,["modelValue"])])]),(0,l._)("div",x,[D,(0,l._)("div",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.productDetail.desc,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"desc-item",key:t},(0,i.zw)(t+1)+"、"+(0,i.zw)(e),1)))),128))])])])]),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(H,{to:{name:"Shopbag"},icon:"bag",text:"购物袋",color:"#646566",badge:e.shopbagCount},null,8,["badge"]),(0,l.Wm)(H,{icon:"like",text:e.isLike?"已收藏":"收藏",color:e.isLike?"#e4393c":"#646566",onClick:e.likeProduct},null,8,["text","color","onClick"]),(0,l.Wm)(L,{color:"#0C34BA",text:"加入购物袋",onClick:t[1]||(t[1]=t=>e.addShopbag())})])),_:1})])}a(6743);var R=a(4691),Z=a(4870),z=a(6478),H=a(6265),L=a.n(H),y=a(678),I=(0,l.aZ)({components:{Navi:z.Z},setup(){let e=(0,y.tv)(),t=(0,y.yj)(),a=(0,Z.iH)(1),i=(0,Z.iH)(""),d=(0,Z.iH)({}),c=(0,Z.iH)(!1),u=(0,Z.iH)(""),n=e=>{L()({method:"get",url:"/productDetail",params:{pid:e}}).then((e=>{if(600===e.data.code){let t=e.data.result[0];t.desc=t.desc.split(/\n/);let a=[],l=["tem","sugar","milk","cream"];l.forEach((e=>{if(""===t[e])return;let l={title:t[`${e}_desc`],activeIndex:0,subRule:[]},i=t[e].split(/\//);i.forEach((e=>{let t={title:e};l.subRule.push(t)})),a.push(l)})),t.rulesData=a,d.value=t}})).catch((e=>{}))},s=(e,t)=>{e.activeIndex!==t&&(e.activeIndex=t)},o=e=>{L()({method:"get",url:"/findlike",params:{pid:e}}).then((e=>{1e3===e.data.code&&e.data.result.length>0&&(c.value=!0)})).catch((e=>{}))},r=()=>{L()({method:"get",url:"/shopcartCount"}).then((e=>{4e3===e.data.code&&(u.value=e.data.result)})).catch((e=>{}))},v=()=>{let t=c.value?"/notlike":"/like";L()({method:"post",url:t,data:{pid:i.value}}).then((t=>{if((0,R.Z)(t.data.msg),700===t.data.code)return e.push({name:"Login"});800===t.data.code?c.value=!0:900===t.data.code&&1===t.data.result&&(c.value=!1)})).catch((e=>{}))},p=()=>{let t=[];d.value.rulesData.forEach((e=>{t.push(e.subRule[e.activeIndex].title)})),L()({method:"post",url:"/addShopcart",data:{pid:i.value,count:a.value,rule:t.join("/")}}).then((t=>{if(700===t.data.code)return(0,R.Z)(t.data.msg),void e.push({name:"Login"});3e3===t.data.code?((0,R.Z)("加入购物袋成功"),u.value=Number(u.value)+a.value):(0,R.Z)("加入购物袋失败")})).catch((e=>{}))};return(0,l.bv)((()=>{i.value=t.params.pid,o(i.value),r(),n(i.value),o(i.value)})),{count:a,pid:i,productDetail:d,isLike:c,shopbagCount:u,likeProduct:v,addShopbag:p,selectRule:s,findCurrentLike:o}}}),W=a(89);const S=(0,W.Z)(I,[["render",C],["__scopeId","data-v-5ddea1b1"]]);var N=S}}]);
//# sourceMappingURL=351.27d20c0c.js.map